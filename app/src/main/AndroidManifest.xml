<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission
        android:name="android.permission.WRITE_EXTERNAL_STORAGE"
        android:maxSdkVersion="28" />
    <uses-permission
        android:name="android.permission.READ_EXTERNAL_STORAGE"
        android:maxSdkVersion="28" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <!--
 Khi bạn muốn crawl dữ liệu từ các trang web, việc lựa chọn foregroundServiceType phù hợp
    sẽ phụ thuộc vào bản chất của công việc crawl và cách ứng dụng của bạn sử dụng dữ liệu thu thập được.
    Dưới đây là một số lựa chọn tiềm năng và lý do tại sao chúng có thể phù hợp:
    1. dataSync:
    Lý do:
    Nếu quá trình crawl dữ liệu của bạn liên quan đến việc đồng bộ hóa dữ liệu từ các trang web với cơ sở dữ liệu cục bộ hoặc máy chủ của bạn, thì dataSync là lựa chọn phù hợp nhất.
    Loại này thường được sử dụng cho các tác vụ tải xuống dữ liệu nền, cập nhật nội dung hoặc sao lưu dữ liệu.
    Ví dụ:
    Ứng dụng đọc tin tức tự động cập nhật bài viết mới từ các trang web tin tức.
    Ứng dụng theo dõi giá sản phẩm tự động cập nhật giá từ các trang web bán hàng trực tuyến.
    -->
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_DATA_SYNC" />
    <!--
    FOREGROUND_SERVICE_TYPE_MEDIA_PLAYBACK: Dành cho phát lại media.
    FOREGROUND_SERVICE_TYPE_LOCATION: Dành cho dịch vụ định vị.
    FOREGROUND_SERVICE_TYPE_DATA_SYNC: Dành cho đồng bộ dữ liệu.
    -->
    <!-- Quyền android.permission.READ_PRIVILEGED_PHONE_STATE là quyền được bảo vệ và chỉ có thể được cấp cho các ứng dụng hệ thống hoặc ứng dụng có chữ ký của nhà sản xuất thiết bị. -->
    <!-- <uses-permission android:name="android.permission.READ_PRIVILEGED_PHONE_STATE" /> -->
    <!--
    <uses-permission android:name="android.permission.READ_PRIVILEGED_PHONE_STATE"
        tools:ignore="ProtectedPermissions" />
    -->
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />

    <queries>

        <!-- Cho phép query tất cả app mở file Excel -->
        <intent>
            <action android:name="android.intent.action.VIEW" />

            <data android:mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />
        </intent>

        <!-- Nếu muốn query luôn app mở file xml -->
        <intent>
            <action android:name="android.intent.action.VIEW" />

            <data android:mimeType="text/xml" />
        </intent>
    </queries>

    <application
        android:name=".MyApplication"
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:requestLegacyExternalStorage="true"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.CrawlerTBDGemini2ModiBasicView"
        tools:targetApi="31">
        <activity
            android:name=".ErrorListActivity"
            android:exported="false" />
        <activity
            android:name=".ExportProgressActivity"
            android:exported="false"
            android:label="@string/exporting_excel_title" />
        <activity
            android:name=".SettingsActivity"
            android:exported="false"
            android:label="@string/action_settings" />
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:theme="@style/Theme.CrawlerTBDGemini2ModiBasicView">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity> <!-- android:authorities="your.package.name.fileprovider" -->
        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.provider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/provider_paths" />
        </provider> <!-- android:foregroundServiceType="dataSync" , "remoteMessaging" -->
        <!-- android:name="androidx.work.impl.foreground.SystemForegroundService" khai báo cũ -->
        <!-- Gemini Khuyên dùng: android:name=".MyWorkerCrawler" -->
        <service
            android:name="androidx.work.impl.foreground.SystemForegroundService"
            android:exported="false"
            android:foregroundServiceType="dataSync"
            tools:targetApi="31" />
        <service
            android:name=".MyWorkerCrawler"
            android:exported="false"
            android:foregroundServiceType="dataSync"
            android:permission="android.permission.FOREGROUND_SERVICE"
            tools:ignore="ClassWithoutPublicConstructor,Instantiatable" />
    </application>

</manifest>